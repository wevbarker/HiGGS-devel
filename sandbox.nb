(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23298,        597]
NotebookOptionsPosition[     21053,        553]
NotebookOutlinePosition[     21449,        569]
CellTagsIndexPosition[     21406,        566]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Sandbox", "Title",
 CellChangeTimes->{{3.856583968969585*^9, 
  3.856583970511949*^9}},ExpressionUUID->"bd5bc2c3-2a94-44d9-b50c-\
f137dee7b4a4"],

Cell["\<\
A notebook to play with code which is not too greedy and is best run locally\
\>", "Text",
 CellChangeTimes->{{3.856583975629859*^9, 
  3.856584001996237*^9}},ExpressionUUID->"ec71a572-a366-4a9c-8516-\
d6f2dd516361"],

Cell[CellGroupData[{

Cell["Load xAct", "Section",
 CellChangeTimes->{{3.856584178130487*^9, 
  3.856584180710792*^9}},ExpressionUUID->"3eaa174f-4b88-4841-847d-\
eab15b3563a2"],

Cell[BoxData[{
 RowBox[{"SetOptions", "[", 
  RowBox[{"$FrontEndSession", ",", 
   RowBox[{
   "EvaluationCompletionAction", "\[Rule]", "\"\<ScrollToOutput\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<xAct`xTras`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<xAct`xPert`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<xAct`xCoba`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Get", "[", "\"\<variations`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ToNewCanonical", "[", "x_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"temp", ",", "printer"}], "}"}], ",", 
      RowBox[{
       RowBox[{"printer", "=", 
        RowBox[{"PrintTemporary", "[", "\"\<Canonicalizing...\>\"", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"temp", "=", "x"}], ";", "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"temp", "//", "ToCanonical"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"temp", "//", "ContractMetric"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"temp", "//", "ScreenDollarIndices"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NotebookDelete", "[", "printer", "]"}], ";", 
       "\[IndentingNewLine]", "temp"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"perturbative", " ", "indices", " ", "in", " ", "red"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "IndexForm", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndexForm", "[", 
    RowBox[{"LI", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{"ColorString", "[", 
    RowBox[{
     RowBox[{"ToString", "[", "x", "]"}], ",", 
     RowBox[{"RGBColor", "[", 
      RowBox[{"1", ",", "0", ",", "0"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "IndexForm", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dimension", "=", "4"}], ";"}], 
  "                                  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"dimension", " ", "of", " ", "space"}], "-", 
    RowBox[{"time", " ", "manifold"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefManifold", "[", 
   RowBox[{"M4", ",", "dimension", ",", 
    RowBox[{"Complement", "[", 
     RowBox[{"IndexRange", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "z"}], "}"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IndexRange", "[", 
   RowBox[{"{", 
    RowBox[{"a", ",", "z"}], "}"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefMetric", "[", 
   RowBox[{
    RowBox[{"-", "1"}], ",", 
    RowBox[{"G", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "c"}]}], "]"}], ",", "CD", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<,\>\"", ",", "\"\<\[Del]\>\""}], "}"}], ",", 
    RowBox[{"PrintAs", "\[Rule]", "\"\<g\>\""}], ",", 
    RowBox[{"SymCovDQ", "\[Rule]", "True"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.856584199883773*^9, 3.856584209680708*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"8350dbcf-aaa6-4a0c-8da4-f0a16f55ce99"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.8565841890131617`*^9, 
  3.85658421162805*^9}},ExpressionUUID->"0bd4bbc6-036d-4780-b248-\
36d87439134e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"$HiGGSBuildTime", "=", 
     RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingData", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingLine", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", ",", "0.", 
       ",", "0.", ",", "0."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingFile", "=", 
     RowBox[{"FileNameJoin", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<bin/\>\"", ",", 
        RowBox[{"\"\<stats\>\"", "<>", 
         RowBox[{"ToString", "@", "$KernelID"}], "<>", "\"\<.csv\>\""}]}], 
       "}"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingNow", "=", 
     RowBox[{
      RowBox[{"AbsoluteTime", "[", "]"}], "-", "$HiGGSBuildTime"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"res", "=", 
     RowBox[{"AbsoluteTiming", "[", 
      RowBox[{"1", "+", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"res", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingDuration", "=", 
     RowBox[{"Evaluate", "@", 
      RowBox[{"res", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingLine", "=", 
     RowBox[{"$HiGGSTimingLine", "~", "ReplacePart", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"$KernelID", "+", "1"}], ")"}], "->", 
        "$HiGGSTimingDuration"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingLine", "=", 
     RowBox[{"$HiGGSTimingLine", "~", "ReplacePart", "~", 
      RowBox[{"(", 
       RowBox[{"9", "->", "$HiGGSTimingNow"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingData", "~", "AppendTo", "~", "$HiGGSTimingLine"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"$HiGGSTimingFile", "~", "Export", "~", "$HiGGSTimingData"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Quit", "[", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.856943392283599*^9, 3.856943430504548*^9}, {
   3.856943463587881*^9, 3.856943484393564*^9}, {3.8569435305513077`*^9, 
   3.856943552625475*^9}, {3.8569436670782957`*^9, 3.856943709630941*^9}, {
   3.856943753606798*^9, 3.856943755808597*^9}, {3.856943891299446*^9, 
   3.8569438945798483`*^9}, {3.85694403375051*^9, 3.856944040199848*^9}, {
   3.85694409160109*^9, 3.8569441252508297`*^9}, {3.856944207617874*^9, 
   3.856944220397924*^9}, {3.856944250755232*^9, 3.8569442534637213`*^9}, {
   3.8569443904044733`*^9, 3.856944417977072*^9}, {3.85694445801663*^9, 
   3.856944459927631*^9}, {3.8569444949886637`*^9, 3.856944528669807*^9}, {
   3.8569445846552896`*^9, 3.856944652435279*^9}, {3.8569448199798517`*^9, 
   3.856944826941568*^9}, {3.85694489966046*^9, 3.856944926851713*^9}, {
   3.8569450684460897`*^9, 3.856945082656152*^9}, {3.856945166380056*^9, 
   3.856945210099015*^9}, {3.856945346775777*^9, 3.85694536896065*^9}, {
   3.856945527676906*^9, 3.856945542052761*^9}, {3.856945631764371*^9, 
   3.8569456321853437`*^9}, {3.856945811612401*^9, 3.85694581177005*^9}, {
   3.856945869080908*^9, 3.856945961809712*^9}, {3.856946048476708*^9, 
   3.8569460523276978`*^9}, {3.8569463990767612`*^9, 
   3.8569464329579973`*^9}, {3.856946490738675*^9, 3.856946534308076*^9}, {
   3.8569466223437*^9, 3.856946684749552*^9}, {3.856946717214408*^9, 
   3.856946849122463*^9}, {3.856946914208324*^9, 3.8569469750323668`*^9}, {
   3.856947011369529*^9, 3.856947122330179*^9}, {3.856947181229432*^9, 
   3.856947267934601*^9}, {3.8569472981954803`*^9, 3.8569474920401087`*^9}, 
   3.856947597428495*^9, {3.856947637354619*^9, 3.8569477730933943`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"2909c569-cebd-4c60-8107-3e3636cc54d2"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.8569440944302998`*^9, 3.856944128427023*^9}, 
   3.856944225518661*^9, 3.856944256464737*^9, 3.856944421901026*^9, 
   3.856944463531673*^9, {3.8569445175498447`*^9, 3.8569445317872353`*^9}, {
   3.856944588158259*^9, 3.856944655659441*^9}, 3.856944829953209*^9, {
   3.8569449135460176`*^9, 3.856944930469816*^9}, {3.8569450620356417`*^9, 
   3.856945085963799*^9}, {3.856945173026585*^9, 3.856945185264686*^9}, 
   3.8569453741693287`*^9, 3.856945968769041*^9, 3.856946056681988*^9, {
   3.856946709226328*^9, 3.856946746275199*^9}, {3.856946777424725*^9, 
   3.856946798216948*^9}, {3.856946836012966*^9, 3.856946852090126*^9}, 
   3.856946940265614*^9, 3.85694697825191*^9, 3.8569470161618567`*^9, {
   3.856947070154188*^9, 3.8569471258848667`*^9}, {3.856947754457272*^9, 
   3.856947769710012*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"70fcebab-8eb8-46fa-89a5-c5d596f3026f"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.8569440944302998`*^9, 3.856944128427023*^9}, 
   3.856944225518661*^9, 3.856944256464737*^9, 3.856944421901026*^9, 
   3.856944463531673*^9, {3.8569445175498447`*^9, 3.8569445317872353`*^9}, {
   3.856944588158259*^9, 3.856944655659441*^9}, 3.856944829953209*^9, {
   3.8569449135460176`*^9, 3.856944930469816*^9}, {3.8569450620356417`*^9, 
   3.856945085963799*^9}, {3.856945173026585*^9, 3.856945185264686*^9}, 
   3.8569453741693287`*^9, 3.856945968769041*^9, 3.856946056681988*^9, {
   3.856946709226328*^9, 3.856946746275199*^9}, {3.856946777424725*^9, 
   3.856946798216948*^9}, {3.856946836012966*^9, 3.856946852090126*^9}, 
   3.856946940265614*^9, 3.85694697825191*^9, 3.8569470161618567`*^9, {
   3.856947070154188*^9, 3.8569471258848667`*^9}, {3.856947754457272*^9, 
   3.8569477697113743`*^9}},
 CellLabel->"Out[8]=",ExpressionUUID->"e3c4f8e4-9475-4aff-94ba-a9d32c0e8c89"]
}, Open  ]],

Cell[BoxData["jk"], "Input",
 CellChangeTimes->{{3.856945995974937*^9, 
  3.856945996242445*^9}},ExpressionUUID->"8ab81cb4-b4c5-436c-a866-\
575b68b5908f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "PoissonBracket", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<ToShell\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<Hard\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"\"\<Surficial\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"\"\<Order\>\"", "\[Rule]", "Infinity"}], ",", 
      RowBox[{"\"\<GToFoliG\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<PreTruncate\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"\"\<NesterForm\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<PrintAnswer\>\"", "->", "True"}], ",", 
      RowBox[{"\"\<Parallel\>\"", "->", "False"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PoissonBracket", "[", 
     RowBox[{"f1x_", ",", "f2x_", ",", 
      RowBox[{"options__", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionQ", "@", "#"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "#", "}"}], "~", "MemberQ", "~", 
             RowBox[{"(", 
              RowBox[{"\"\<Parallel\>\"", "->", "True"}], ")"}]}], ")"}]}], 
          ")"}], "&"}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Build", " ", "the", " ", "HiGGS", " ", "environment"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"BuildHiGGS", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<cookie\>\"", "]"}], "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{"Define", " ", "the", " ", "theory"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"DefTheory", "[", 
         RowBox[{"\"\<Import\>\"", "->", "$TheoryName"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Evaluate", " ", "the", " ", "Poisson", " ", "bracket"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"PoissonBracket", "[", 
        RowBox[{"f1x", ",", "f2x", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "options", "}"}], "~", "Complement", "~", 
            RowBox[{"{", 
             RowBox[{"\"\<Parallel\>\"", "->", "True"}], "}"}]}], ")"}], "/.", 
          RowBox[{"{", 
           RowBox[{"List", "->", "Sequence"}], "}"}]}]}], "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PoissonBracket", "[", 
    RowBox[{"f1x_", ",", "f2x_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Print", "[", "cbo", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "try", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PoissonBracket", "[", 
   RowBox[{
    RowBox[{"PhiB0p", "[", "]"}], ",", 
    RowBox[{"PhiB2p", "[", 
     RowBox[{
      RowBox[{"-", "i"}], ",", 
      RowBox[{"-", "j"}]}], "]"}], ",", 
    RowBox[{"\"\<Parallel\>\"", "->", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PoissonBracket", "[", 
   RowBox[{
    RowBox[{"PhiB0p", "[", "]"}], ",", 
    RowBox[{"PhiB2p", "[", 
     RowBox[{
      RowBox[{"-", "i"}], ",", 
      RowBox[{"-", "j"}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "tro", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"OptionQ", "@", "#"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "#", "}"}], "~", "MemberQ", "~", 
       RowBox[{"(", 
        RowBox[{"\"\<Parallel\>\"", "->", "True"}], ")"}]}], ")"}]}], ")"}], 
   "&"}], "@", 
  RowBox[{"(", 
   RowBox[{"\"\<Parallel\>\"", "->", "rue"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Parallel\>\"", "->", "True"}], "\[IndentingNewLine]", 
 RowBox[{"QQ", "=", "\"\<hi\>\""}], "\[IndentingNewLine]", 
 RowBox[{"!", "QQ"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"StringQ", "@", "QQ"}], ",", 
    RowBox[{"Print", "[", "\"\<do\>\"", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<donot\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"func", "[", "x_", "]"}], ":=", 
  RowBox[{"funcf", "[", 
   RowBox[{"a", ",", "b", ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"funccc", "[", 
  RowBox[{"x", ",", "y", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{"List", "->", "Sequence"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Quit", "[", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"T", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], ",", "M4"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzFsoQwEAxvFDq2nKLeHJJUKUJ1421BrNsi02nCGFIst9MabUPExI7EGr
obWJh22GXHK3LElrSmSlybxMClFsaGc4n4ev39P3T2vulrSEEwSRTA+yxsyO
m/1nbi8hPYGepKkzeBvX4II5D3kb0QfPXGHG1RH8yrd2xNByz4Sd8F7DsMCa
PbUNskSNm1Bcwt6BjjXvMXQrLKfwUT7ohEE70/X/W5VfwpVD6l/Z/lIQ6sZf
KMjjE9mxtGzlUy7U6hiT8FEQ0sJRe+4cTHDOmmAgXbIO9bvvW3DdT4UgNZf2
CxXV3xFx6PnaWDBgl5XCsUMfH5Zzsiqg8nyPhNcaczv0NLx3wTDm8QDMpHpU
kCCjNPAupXIC1g2nGuCie8QIf8psnHjavvMPLlS/FfAhwzovgDMHkWJo3H6V
wqqm4lrY6q+sh9Mh7xC86NvVQJNLNQ5/Cpf1MFErMkAeyTfChdlPM+wniyzw
D+pH+8Y=
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"cc046b09-268c-4885-b833-f1a4ccccb221"],

Cell[CellGroupData[{

Cell[BoxData["try"], "Print",
 CellChangeTimes->{{3.856704620051697*^9, 3.856704721000452*^9}, 
   3.856704787438109*^9, 3.8567048531188183`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"2f05b60a-fe88-46b8-859c-ee1c5018c3a4"],

Cell[BoxData["\<\"cookie\"\>"], "Print",
 CellChangeTimes->{{3.856704620051697*^9, 3.856704721000452*^9}, 
   3.856704787438109*^9, 3.856704853120345*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"8bdb6df3-acc4-42ed-a002-daea190d7893"],

Cell[BoxData["cbo"], "Print",
 CellChangeTimes->{{3.856704620051697*^9, 3.856704721000452*^9}, 
   3.856704787438109*^9, 3.85670485312181*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a4a5451d-9a41-4fa4-8cc6-716a61b1fa85"],

Cell[BoxData["cbo"], "Print",
 CellChangeTimes->{{3.856704620051697*^9, 3.856704721000452*^9}, 
   3.856704787438109*^9, 3.856704853122877*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"6bcd2c5b-3006-446d-86b9-5d67e1e33687"],

Cell[BoxData["tro"], "Print",
 CellChangeTimes->{{3.856704620051697*^9, 3.856704721000452*^9}, 
   3.856704787438109*^9, 3.856704853124011*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"717ed69b-548b-4291-92a8-414d4b4bac21"]
}, Open  ]],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.856704620059333*^9, 3.856704721008231*^9}, 
   3.856704787443932*^9, 3.856704853125533*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"8ce58508-58f2-4454-8630-0e484f31a243"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DefTensor", "[", 
  RowBox[{
   RowBox[{"W", "[", "]"}], ",", "M4"}], "]"}]], "Input",
 CellChangeTimes->{{3.856584578459114*^9, 3.856584590227648*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"dafd3f2f-06b9-4378-b24c-b8ce3185a3b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DefTensor", "[", 
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}], ",", "M4"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8565846538324223`*^9, 3.856584654110827*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"fc2d8411-1e3d-4105-9991-a6dad21e6e1c"],

Cell[BoxData[{
 RowBox[{"$IfConstraints", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"W", "[", "]"}], ",", 
    RowBox[{"T", "[", 
     RowBox[{"e", ",", 
      RowBox[{"-", "y"}]}], "]"}], ",", 
    RowBox[{"J", "[", 
     RowBox[{
      RowBox[{"-", "a"}], ",", 
      RowBox[{"-", "b"}]}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"IndIfConstraints", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"#", "~", "ChangeFreeIndices", "~", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "l"}], ",", 
          RowBox[{"-", "m"}], ",", 
          RowBox[{"-", "n"}]}], "}"}], "~", "Take", "~", 
        RowBox[{"Length", "@", 
         RowBox[{"FindFreeIndices", "@", "#"}]}]}], ")"}]}], ")"}], "&"}], "/@",
    "$IfConstraints"}]}], "\[IndentingNewLine]", 
 RowBox[{"PrimaryPoissonMatrix", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"$IfConstraints", "[", 
       RowBox[{"[", "ii", "]"}], "]"}], ",", 
      RowBox[{"IndIfConstraints", "[", 
       RowBox[{"[", "jj", "]"}], "]"}], ",", 
      RowBox[{"PoissonBracket", "[", 
       RowBox[{
        RowBox[{"$IfConstraints", "[", 
         RowBox[{"[", "ii", "]"}], "]"}], ",", 
        RowBox[{"IndIfConstraints", "[", 
         RowBox[{"[", "jj", "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"ii", ",", 
      RowBox[{"Length", "@", "$IfConstraints"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"jj", ",", "ii", ",", 
      RowBox[{"Length", "@", "$IfConstraints"}]}], "}"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.856584389506646*^9, 3.856584399359087*^9}, {
   3.856584430732074*^9, 3.8565844783592453`*^9}, 3.856584561197136*^9, {
   3.856584594847447*^9, 3.8565845982261953`*^9}, {3.856584657472745*^9, 
   3.856584746816399*^9}, {3.856584795921524*^9, 3.8565847970473948`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d6823222-641b-483b-96da-a007d33de805"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440., 789.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2aa722bc-ce5d-41ed-9e06-10088b8a8e7a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 150, 3, 98, "Title",ExpressionUUID->"bd5bc2c3-2a94-44d9-b50c-f137dee7b4a4"],
Cell[733, 27, 226, 5, 35, "Text",ExpressionUUID->"ec71a572-a366-4a9c-8516-d6f2dd516361"],
Cell[CellGroupData[{
Cell[984, 36, 154, 3, 68, "Section",ExpressionUUID->"3eaa174f-4b88-4841-847d-eab15b3563a2"],
Cell[1141, 41, 3460, 96, 484, "Input",ExpressionUUID->"8350dbcf-aaa6-4a0c-8da4-f0a16f55ce99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4638, 142, 151, 3, 68, "Section",ExpressionUUID->"0bd4bbc6-036d-4780-b248-36d87439134e"],
Cell[CellGroupData[{
Cell[4814, 149, 4312, 91, 443, "Input",ExpressionUUID->"2909c569-cebd-4c60-8107-3e3636cc54d2"],
Cell[9129, 242, 933, 13, 33, "Output",ExpressionUUID->"70fcebab-8eb8-46fa-89a5-c5d596f3026f"],
Cell[10065, 257, 937, 13, 33, "Output",ExpressionUUID->"e3c4f8e4-9475-4aff-94ba-a9d32c0e8c89"]
}, Open  ]],
Cell[11017, 273, 154, 3, 29, "Input",ExpressionUUID->"8ab81cb4-b4c5-436c-a866-575b68b5908f"],
Cell[CellGroupData[{
Cell[11196, 280, 5706, 152, 628, "Input",ExpressionUUID->"cc046b09-268c-4885-b833-f1a4ccccb221"],
Cell[CellGroupData[{
Cell[16927, 436, 249, 5, 23, "Print",ExpressionUUID->"2f05b60a-fe88-46b8-859c-ee1c5018c3a4"],
Cell[17179, 443, 258, 5, 23, "Print",ExpressionUUID->"8bdb6df3-acc4-42ed-a002-daea190d7893"],
Cell[17440, 450, 246, 5, 23, "Print",ExpressionUUID->"a4a5451d-9a41-4fa4-8cc6-716a61b1fa85"],
Cell[17689, 457, 247, 5, 23, "Print",ExpressionUUID->"6bcd2c5b-3006-446d-86b9-5d67e1e33687"],
Cell[17939, 464, 247, 5, 23, "Print",ExpressionUUID->"717ed69b-548b-4291-92a8-414d4b4bac21"]
}, Open  ]],
Cell[18201, 472, 224, 3, 33, "Output",ExpressionUUID->"8ce58508-58f2-4454-8630-0e484f31a243"]
}, Open  ]],
Cell[18440, 478, 255, 5, 29, "Input",ExpressionUUID->"dafd3f2f-06b9-4378-b24c-b8ce3185a3b7"],
Cell[18698, 485, 352, 9, 29, "Input",ExpressionUUID->"fc2d8411-1e3d-4105-9991-a6dad21e6e1c"],
Cell[19053, 496, 1972, 53, 92, "Input",ExpressionUUID->"d6823222-641b-483b-96da-a007d33de805"]
}, Open  ]]
}, Open  ]]
}
]
*)

